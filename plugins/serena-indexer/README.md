# Serena Indexer Plugin

ä¸“ä¸šçš„ Serena ç´¢å¼•ç®¡ç†æ’ä»¶ï¼Œä¸º Claude Code æä¾›å¼‚æ­¥ç´¢å¼•åˆå§‹åŒ–ã€æ™ºèƒ½é‡å»ºå’Œè‡ªåŠ¨åŒ–ç»´æŠ¤åŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…æ’ä»¶

```bash
# æ·»åŠ å¸‚åœºï¼ˆå¦‚æœå°šæœªæ·»åŠ ï¼‰
/plugin marketplace add wshobson/agents

# å®‰è£… Serena Indexer æ’ä»¶
/plugin install serena-indexer
```

### åŸºç¡€ä½¿ç”¨

```bash
# é¦–æ¬¡ä½¿ç”¨ - åˆå§‹åŒ–ç´¢å¼•
/serena-index --generate-config

# æŸ¥çœ‹ç´¢å¼•çŠ¶æ€
/serena-status

# æ™ºèƒ½æ›´æ–°ç´¢å¼•ï¼ˆä»…åœ¨éœ€è¦æ—¶ï¼‰
/serena-index --smart
```

## ğŸ“‹ åŠŸèƒ½æ¦‚è§ˆ

### æ ¸å¿ƒå‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `/serena-index` | å¼‚æ­¥ç´¢å¼•åˆå§‹åŒ–å’Œé‡å»º | é¡¹ç›®é¦–æ¬¡ä½¿ç”¨ã€é‡å¤§å˜æ›´å |
| `/serena-status` | ç´¢å¼•çŠ¶æ€æŸ¥è¯¢å’Œå¥åº·æ£€æŸ¥ | ç›‘æ§ç´¢å¼•çŠ¶æ€ã€æ€§èƒ½åˆ†æ |
| `/serena-cleanup` | ç´¢å¼•æ•°æ®æ¸…ç†å’Œä¼˜åŒ– | ç£ç›˜ç©ºé—´ç®¡ç†ã€æ€§èƒ½ä¼˜åŒ– |

### ä¸“ä¸šä»£ç†

- **Serena Indexer**: å¼‚æ­¥ç´¢å¼•æ‰§è¡Œä¸“å®¶
- **Serena Monitor**: ç´¢å¼•å¥åº·ç›‘æ§ä¸“å®¶

### è‡ªåŠ¨åŒ–åŠŸèƒ½

- **æ™ºèƒ½ç´¢å¼•å†³ç­–**: è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ç´¢å¼•
- **è‡ªåŠ¨ç»´æŠ¤é’©å­**: ä¼šè¯å¼€å§‹æ—¶è‡ªåŠ¨æ£€æŸ¥ç´¢å¼•çŠ¶æ€
- **æ€§èƒ½ä¼˜åŒ–**: è‡ªåŠ¨æ¸…ç†ç¼“å­˜å’Œä¼˜åŒ–ç´¢å¼•ç»“æ„

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. é¡¹ç›®åˆå§‹åŒ–
```bash
# æ–°é¡¹ç›®é¦–æ¬¡è®¾ç½®
/serena-index --generate-config

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ… é…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: .serena/project.yml
# ğŸš€ å¼€å§‹ Serena ç´¢å¼•...
# âœ… ç´¢å¼•å®Œæˆï¼å¤„ç†äº† 156 ä¸ªæ–‡ä»¶ï¼Œæå–äº† 1,247 ä¸ªç¬¦å·
```

### 2. æ—¥å¸¸å¼€å‘
```bash
# æ™ºèƒ½æ›´æ–°ï¼ˆæ¨èæ—¥å¸¸ä½¿ç”¨ï¼‰
/serena-index --smart

# è¾“å‡ºç¤ºä¾‹ï¼š
# ğŸ” æ£€æŸ¥ç´¢å¼•çŠ¶æ€...
# âœ… ç´¢å¼•ä»ç„¶æ–°é²œï¼ˆ1å°æ—¶å‰ï¼‰ï¼Œè·³è¿‡ç´¢å¼•
# æˆ–
# ğŸ”„ æ£€æµ‹åˆ° 12 ä¸ªæ–‡ä»¶å˜æ›´ï¼Œæ­£åœ¨æ›´æ–°ç´¢å¼•...
```

### 3. æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
/serena-status --detailed

# è¾“å‡ºç¤ºä¾‹ï¼š
# ğŸ“Š Serena è¯¦ç»†ç´¢å¼•çŠ¶æ€
# çŠ¶æ€: âœ… å¥åº· | ç´¢å¼•å¤§å°: 23.4 MB | ç¬¦å·æ•°é‡: 1,847
# æ€§èƒ½: å¹³å‡æŸ¥è¯¢ 45ms | ç¼“å­˜å‘½ä¸­ç‡ 87% | å†…å­˜å ç”¨ 34MB
```

### 4. é—®é¢˜è¯Šæ–­
```bash
# å¥åº·æ£€æŸ¥
/serena-status --health

# æ¸…ç†ä¼˜åŒ–
/serena-cleanup --cache-only

# å¼ºåˆ¶é‡å»ºï¼ˆé—®é¢˜è§£å†³ï¼‰
/serena-index --reindex --force
```

## âš™ï¸ é«˜çº§é…ç½®

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# ç´¢å¼•æ€§èƒ½è°ƒä¼˜
export SERENA_CACHE_ENABLED=true
export SERENA_PARALLEL_WORKERS=4
export SERENA_LOG_LEVEL=info

# æ¸…ç†ç­–ç•¥é…ç½®
export SERENA_CLEANUP_KEEP_DAYS=7
export SERENA_AUTO_BACKUP_THRESHOLD=100
```

### ç´¢å¼•ç­–ç•¥é…ç½®

åœ¨ `.serena/project.yml` ä¸­è‡ªå®šä¹‰ç´¢å¼•è¡Œä¸ºï¼š

```yaml
# é¡¹ç›®é…ç½®ç¤ºä¾‹
project:
  name: "my-awesome-project"
  type: "go"

# ç´¢å¼•ç­–ç•¥
indexing:
  strategy: "smart"  # full, incremental, smart
  include_patterns:
    - "*.go"
    - "*.md"
    - "*.yaml"
  exclude_patterns:
    - "vendor/*"
    - "*.pb.go"
    - "*_test.go"

# æ€§èƒ½é…ç½®
performance:
  parallel_workers: 4
  cache_size: "100MB"
  timeout: 600  # ç§’

# ç›‘æ§é…ç½®
monitoring:
  health_check_interval: 3600  # ç§’
  auto_cleanup: true
  performance_tracking: true
```

### è‡ªåŠ¨åŒ–é’©å­é…ç½®

```bash
# è®¾ç½®è‡ªåŠ¨ç´¢å¼•ï¼ˆæ¨èï¼‰
/serena-index --setup-hooks

# äº¤äº’å¼é…ç½®ï¼š
# ? é€‰æ‹©é…ç½®èŒƒå›´: é¡¹ç›®é…ç½®ï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰
# ? é€‰æ‹©è§¦å‘æ—¶æœº: SessionStartï¼ˆä¼šè¯å¼€å§‹æ—¶ï¼‰
# ? é€‰æ‹©ç´¢å¼•ç­–ç•¥: æ™ºèƒ½åˆ¤æ–­ï¼ˆæ¨èï¼‰
# âœ… Hook é…ç½®å·²å®Œæˆ
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç´¢å¼•å¤±è´¥
```bash
âŒ ç´¢å¼•æ‰§è¡Œå¤±è´¥

è§£å†³æ–¹æ¡ˆï¼š
1. æ£€æŸ¥ç¯å¢ƒï¼šPythonã€uvx å·¥å…·æ˜¯å¦å®‰è£…
2. éªŒè¯æƒé™ï¼šç¡®ä¿ .serena ç›®å½•å¯å†™
3. æ¸…ç†é‡è¯•ï¼š/serena-cleanup --all && /serena-index
4. æŸ¥çœ‹æ—¥å¿—ï¼šæ£€æŸ¥è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

#### 2. æ€§èƒ½é—®é¢˜
```bash
âš ï¸ æŸ¥è¯¢å“åº”å˜æ…¢

è¯Šæ–­æ­¥éª¤ï¼š
1. æ£€æŸ¥çŠ¶æ€ï¼š/serena-status --performance
2. æ¸…ç†ç¼“å­˜ï¼š/serena-cleanup --cache-only
3. é‡å»ºç´¢å¼•ï¼š/serena-index --reindex
4. è°ƒæ•´é…ç½®ï¼šå‡å°‘å¹¶è¡Œå·¥ä½œçº¿ç¨‹æ•°
```

#### 3. ç£ç›˜ç©ºé—´ä¸è¶³
```bash
ğŸ’¾ ç£ç›˜ç©ºé—´ä¸è¶³

è§£å†³æ–¹æ¡ˆï¼š
1. æ¸…ç†æ•°æ®ï¼š/serena-cleanup --aggressive
2. æ‰‹åŠ¨æ¸…ç†ï¼šåˆ é™¤ .serena/backup_*.tar.gz
3. è°ƒæ•´ç­–ç•¥ï¼šå‡å°‘ç´¢å¼•ä¿ç•™å¤©æ•°
4. æ‰©å®¹å­˜å‚¨ï¼šç§»åŠ¨ç´¢å¼•åˆ°æ›´å¤§åˆ†åŒº
```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
export SERENA_LOG_LEVEL=debug

# æ‰§è¡Œç´¢å¼•å¹¶æŸ¥çœ‹è¯¦ç»†è¾“å‡º
/serena-index 2>&1 | tee serena-index.log

# åˆ†ææ—¥å¿—æ–‡ä»¶
grep -E "(ERROR|WARN|FAIL)" serena-index.log
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç´¢å¼•ç­–ç•¥ä¼˜åŒ–
- **å°é¡¹ç›®** (< 100 æ–‡ä»¶): ä½¿ç”¨å®Œæ•´ç´¢å¼•ï¼Œæ›´æ–°é¢‘ç‡ä½
- **ä¸­å‹é¡¹ç›®** (100-1000 æ–‡ä»¶): ä½¿ç”¨æ™ºèƒ½ç´¢å¼•ï¼Œå¢é‡æ›´æ–°
- **å¤§å‹é¡¹ç›®** (> 1000 æ–‡ä»¶): ä½¿ç”¨æ™ºèƒ½ç´¢å¼•ï¼Œå¹¶è¡Œå¤„ç†

### 2. ç¼“å­˜ç­–ç•¥
- **å¼€å‘ç¯å¢ƒ**: å¯ç”¨å¤§ç¼“å­˜ï¼Œä¼˜å…ˆæ€§èƒ½
- **CI/CD ç¯å¢ƒ**: ç¦ç”¨ç¼“å­˜ï¼ŒèŠ‚çœç©ºé—´
- **ç”Ÿäº§ç¯å¢ƒ**: å¹³è¡¡ç¼“å­˜å¤§å°å’Œæ€§èƒ½

### 3. ç›‘æ§é¢‘ç‡
- **æ´»è·ƒé¡¹ç›®**: æ¯æ—¥å¥åº·æ£€æŸ¥
- **ç¨³å®šé¡¹ç›®**: æ¯å‘¨çŠ¶æ€æ£€æŸ¥
- **ç»´æŠ¤æ¨¡å¼**: æŒ‰éœ€æ£€æŸ¥

## ğŸ”— é›†æˆç¤ºä¾‹

### ä¸ Git å·¥ä½œæµé›†æˆ
```bash
# åœ¨ .git/hooks/post-merge ä¸­æ·»åŠ ï¼š
#!/bin/bash
/serena-index --smart &
```

### ä¸ CI/CD é›†æˆ
```yaml
# GitHub Actions ç¤ºä¾‹
- name: Update Serena Index
  run: |
    claude /serena-index --smart
    claude /serena-status --health
```

### ä¸ IDE é›†æˆ
```bash
# VS Code ä»»åŠ¡é…ç½®
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Update Serena Index",
      "type": "shell",
      "command": "claude",
      "args": ["/serena-index", "--smart"]
    }
  ]
}
```

## ğŸ“ˆ ç›‘æ§å’ŒæŠ¥å‘Š

### å¥åº·åº¦è¯„åˆ†
```yaml
è¯„åˆ†ä½“ç³»:
  90-100: ä¼˜ç§€ - æ— éœ€å…³æ³¨
  80-89: è‰¯å¥½ - å»ºè®®ä¼˜åŒ–
  70-79: ä¸€èˆ¬ - éœ€è¦å…³æ³¨
  <70: è¾ƒå·® - éœ€è¦ç«‹å³å¤„ç†
```

### æ€§èƒ½åŸºå‡†
```yaml
æ€§èƒ½æŒ‡æ ‡:
  æŸ¥è¯¢å“åº”æ—¶é—´:
    ä¼˜ç§€: <50ms
    è‰¯å¥½: 50-100ms
    ä¸€èˆ¬: 100-200ms
    è¾ƒå·®: >200ms

  ç¼“å­˜å‘½ä¸­ç‡:
    ä¼˜ç§€: >90%
    è‰¯å¥½: 80-90%
    ä¸€èˆ¬: 70-80%
    è¾ƒå·®: <70%
```

## ğŸ¤ è´¡çŒ®å’Œæ”¯æŒ

### æŠ¥å‘Šé—®é¢˜
- ä½¿ç”¨ GitHub Issues æŠ¥å‘Š bug
- æä¾›è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œç¯å¢ƒä¿¡æ¯
- åŒ…å«é‡ç°æ­¥éª¤å’Œé¢„æœŸè¡Œä¸º

### åŠŸèƒ½è¯·æ±‚
- æè¿°æ–°åŠŸèƒ½çš„ç”¨ä¾‹å’Œä»·å€¼
- æä¾›è®¾è®¡å»ºè®®å’Œå®ç°æ€è·¯
- è€ƒè™‘å‘åå…¼å®¹æ€§

### å¼€å‘è´¡çŒ®
- Fork é¡¹ç›®å¹¶åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
- éµå¾ªä»£ç è§„èŒƒå’Œæµ‹è¯•è¦æ±‚
- æäº¤ Pull Request å¹¶æè¿°å˜æ›´å†…å®¹

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](../../LICENSE) æ–‡ä»¶ã€‚

---

**è®© Serena ç´¢å¼•ä¸ºä½ çš„å¼€å‘æ•ˆç‡èµ‹èƒ½ï¼** ğŸš€